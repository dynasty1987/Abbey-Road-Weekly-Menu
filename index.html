<script>
    document.addEventListener('DOMContentLoaded', function () {
        Tabletop.init({
            key: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS1oAuoPPK2B3bp9AYcnJsiPnhUhaKYnXKIGx81PLXQDM3NcTX0DftPmbF3tJxESiav5MN-CAABuXEs/pubhtml',
            simpleSheet: true,
            callback: function(data) {
                let menuContainer = document.getElementById('menu');
                let days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];

                days.forEach(day => {
                    let dayMenu = data.filter(item => item.Day === day);
                    let dayBox = document.createElement('div');
                    dayBox.className = 'day-box';

                    let dayTitle = document.createElement('h2');
                    dayTitle.textContent = day;
                    dayBox.appendChild(dayTitle);

                    dayMenu.forEach(item => {
                        // Hot Dish
                        if (item["Hot Dishes"]) {
                            let hotDish = document.createElement('div');
                            hotDish.innerHTML = `<strong>Hot:</strong> ${item["Hot Dishes"]} (${item["Hot Kcal"]}) - ${item["Hot Dish Price"]}`;
                            dayBox.appendChild(hotDish);
                        }
                        // Soup
                        if (item["Soup"]) {
                            let soupDish = document.createElement('div');
                            soupDish.innerHTML = `<strong>Soup:</strong> ${item["Soup"]} (${item["Soup Kcal"]}) - ${item["Soup Price"]}`;
                            dayBox.appendChild(soupDish);
                        }
                        // Deli
                        if (item["Deli"]) {
                            let deliDish = document.createElement('div');
                            deliDish.innerHTML = `<strong>Deli:</strong> ${item["Deli"]} (${item["Deli Kcal"]})`;
                            dayBox.appendChild(deliDish);
                        }
                        // Salad
                        if (item["Composite Salads"]) {
                            let saladDish = document.createElement('div');
                            saladDish.innerHTML = `<strong>Salad:</strong> ${item["Composite Salads"]} (${item["Salad Kcal"]})`;
                            dayBox.appendChild(saladDish);
                        }
                    });

                    menuContainer.appendChild(dayBox);
                });
            }
        });
    });
</script>
